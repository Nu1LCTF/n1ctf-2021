# Checkin

- Calculate the upper and lower bounds on $x$ based on the given higher 22 bits of $p$.

- Based on $h \equiv x + x^{-1} \pmod{n}$,  we can derive another equation $x^2-hx+1 \equiv 0 \pmod{n}$.

- Apply coppersmith's attack with $\epsilon = 0.02$, and run it for about a minute to recover $x$.
- Calculate $p$ and $q$ based on $x$ and $n$, and then decrypt the ciphertext to get flag.

~~~python
from Crypto.Util.number import *
n = 124592923216765837982528839202733339713655242872717311800329884147642320435241014134533341888832955643881019336863843062120984698416851559736918389766033534214383285754683751490292848191235308958825702189602212123282858416891155764271492033289942894367802529296453904254165606918649570613530838932164490341793
c = 119279592136391518960778700178474826421062018379899342254406783670889432182616590099071219538938202395671695005539485982613862823970622126945808954842683496637377151180225469409261800869161467402364879561554585345399947589618235872378329510108345004513054262809629917083343715270605155751457391599728436117833
h = 115812446451372389307840774747986196103012628652193338630796109042038320397499948364970459686079508388755154855414919871257982157430015224489195284512204803276307238226421244647463550637321174259849701618681565567468929295822889537962306471780258801529979716298619553323655541002084406217484482271693997457806
p0 = 4055618

lb = 2021*(p0<<490)+1120*n//(p0<<490)
ub = 2021*((p0+1)<<490)+1120*n//((p0+1)<<490)
print(int(ub-lb).bit_length())
PR.<x> = PolynomialRing(Zmod(n))
f = (x+lb)^2-h*(x+lb)+1
y = f.small_roots(X=ub-lb,epsilon=0.02)
s1 = int(y[0])+lb
s2 = (s1*s1-4*2021*1120*n)**(1/2)
p = (s1+s2)//4042
q = (s1-s2)//2240
d = inverse(65537,int((p-1)*(q-1)))
m = pow(c,d,n)
print(long_to_bytes(m))

~~~
